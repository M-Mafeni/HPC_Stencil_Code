\documentclass{article}
\usepackage{geometry}
 \geometry{
 a4paper,
 margin = 1in,
 bottom = 1in
 }
\title{Serial Optimisation Report}
\author{Michael Mafeni mm17291}
\begin{document}
    \maketitle
    \newpage
    \section{Optimisations used}
        Note: all times quoted are for the stencil_1024_1024_100.pgm file
        \paragraph{}

        In order to increase the performance of the stencil code given, I first used gprof to see where most of the runtime was going. I found that 99\% of the time was being spent in the stencil function. However, Before I began to optimise the code, I first optimised the compiler. I did this by using the many optimisation flags available the times that I got can be found in the table below. It ran fastest with the -Ofast flag at 1.8 seconds.
        \paragraph{}
        After I had optimised the compiler, I had begun to optimise the code. The first thing I noticed was the order of iteration. It was in a column major layout which didn't match the memory layout so I switched the for loops around in order to rectify this. This brought the runtime down to 0.67 seconds on gcc 9. On the Intel Compiler, this was 0.18 seconds. I then optimised the code by reducing the amount of operations it was doing. I stored repeatwd values in local variables and factorised the algorithm so it was doing less multiplication. Finally I noticed that the image was being stored as a 2d array of Doubles where a 2d array of floats would suffice as you did not need that much precision. This brought it down to 0.10 seconds.
    \section{Comparisons of optimised vs unoptimsed code}
\nocite{*}
\bibliographystyle{plain}
\bibliography{test}
\end{document}
